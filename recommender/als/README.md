# 協同式過濾
推薦系統分兩種，內容過濾與協同式過濾。我們採用協同式過濾系統。協同式過濾系統透過所有使用者與商品的互動歷史來產生推薦模型，進而預測特定使用者對特定商品的喜好

# 推薦系統
我們的目標是做影集的推薦，但是我們卻無法找到任何使用者對影集評分的資料, 所以我們只好退而求其次透過使用者對電影的評分來產出影集推薦清單。

## 資料集
1. 162541 人
2. 62423 部電影
3. 25000095 個評分


我們使用 movielens 的資料集來進行模型訓練, 資料集的特點:
總共 162541 人對 62423 部電影做出 250萬筆 個評分, 所有使用者至少對 20 部電影作出評分。

# 資料稀疏性
我們研究分析了 movielens 所提供的資料，發現大約只有一萬三千五百部電影擁有超過一百個評分，其餘的電影都很少或甚至沒有評分。80% 的互動都集中在 20 % 的電影上。我們把資料轉換成矩陣來看會發現很多的缺值。

## 矩陣分解
在協同過濾的世界裏面，有一種技巧叫做矩陣分解專門解決資料稀疏性的問題。
矩陣分解是線性代數種一種技巧，顧名思義就是把一個矩陣分解成多個矩陣的積。
在協同式過濾的範疇之下，矩陣分解演算法透過分解使用者對電影的評分矩陣至兩個低維度的矩陣， 這兩個結果矩陣可以分別視為一個是使用者矩陣, 每列代表一個使用者, 欄位是隱性變數, 令一個矩陣是電影矩陣, 列代表隱性變數, 每欄代表一部電影。

## 矩陣分解的好處

1. 透過矩陣分解我們可以得到更個人化的推薦
2. 矩陣分解可以讓比較不有名的電影在低維度的的情況下和人氣電影一樣擁有相同程度的隱性變數，進而讓推薦系統達到推薦較不知名電影。

## ALS on SparkML
ALS 是一種可以分散式運算的矩陣分解演算法。Spark ML library 的 ALS 就是專門針對大型協同過濾所開發的工具。

## ALS 模型訓練
ALS 模型訓練中, 我們必須調整迭代次數參數來找出最小 RMSE 值，RMSE 越小代表模型預測測試集資料評分越準
我們可以寫一個 for 迴圈來找出 最小 RMSE 值。根據結果我們選擇迭代 10 次作爲我們的推薦模型

## 模型應用
我們使用產出的模型對所有使用者推薦 5 部電影，然後把結果 data frame 儲存起來給應用程式使用

## ML Pipeline 冷啟動
冷啟動是協同式過濾推薦系統的一個問題。因為系統中沒有新註冊會員的資料，所以當下無從推薦。但是我們還是必須要打造一個 pipeline 來收集這些會員的互動資訊。

# ALS 矩陣分解協同式過濾












