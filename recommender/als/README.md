# ALS 矩陣分解協同式過濾
我現在要來向大家展示我們的推薦模型訓練過程。我們的目標做影集的推薦，但是我們卻無法找到任何使用者對影集評分的資料, 所以我們只好退而求其次透過使用者對電影的評分來產出影集推薦清單。
我們使用 movielens 的資料集來進行模型訓練, 資料集的特點:

## 資料集
1. 162541 人
2. 62423 部電影
3. 25000095 個評分

總共 162541 人對 62423 部電影做出 25000095 個評分, 所有使用者至少對 20 部電影作出評分。

## 矩陣分解
矩陣分解是線性代數種一種技巧，顧名思義就是把一個矩陣分解成多個矩陣的積。講白話就是找出一個數的質因數分解例如 15 可以分解成 3 x 5
在協同式過濾的範疇之下，矩陣分解演算法透過分解使用者對電影的評分矩陣至兩個低維度的矩陣， 這兩個結果矩陣可以分別視為一個是使用者矩陣, 每列代表一個使用者, 欄位是隱性變數, 令一個矩陣是電影矩陣, 列代表隱性變數, 每欄代表一部電影。

## 矩陣分解如何預推薦

1. 透過矩陣分解我們可以得到更個人化的推薦
2. 矩陣分解可以讓比較不有名的電影在低維度的的情況下和人氣電影一樣擁有相同程度的隱性變數，進而讓推薦系統達到推薦較不知名電影。

## ALS on SparkML
ALS 是矩陣分解演算法其中一種，而且是平行運算。Spark ML library 的 ALS 就是專門針對大型協同過濾所開發的工具。

## ALS 模型訓練
ALS 模型訓練中, 我們必須調整迭代次數參數來找出最小 RMSE 值，RMSE 越小代表模型預測評分越準
我們可以寫一個 for 迴圈來找出 最小 RMSE 值。根據結果我們選擇迭代 10 次作爲我們的推薦模型



## 模型應用
我們使用產出的模型對所有使用者推薦 5 部電影，然後把結果 data frame 儲存起來給應用程式使用